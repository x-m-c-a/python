import tensorflow as tf  
from tensorflow.keras import layers, models  
import numpy as np  
import matplotlib.pyplot as plt

def create_lenet5(input_shape=(32, 32, 1)):  
    model = models.Sequential()  
      
    # 第一层卷积层 + 池化层  
    model.add(layers.Conv2D(6, (5, 5), activation='relu', input_shape=input_shape))  
    model.add(layers.AveragePooling2D((2, 2)))  
      
    # 第二层卷积层 + 池化层  
    model.add(layers.Conv2D(16, (5, 5), activation='relu'))  
    model.add(layers.AveragePooling2D((2, 2)))  
      
    # 展平层  
    model.add(layers.Flatten())  
      
    # 全连接层  
    model.add(layers.Dense(120, activation='relu'))  
    model.add(layers.Dense(84, activation='relu'))  
      
    # 输出层  
    model.add(layers.Dense(10, activation='softmax'))  
      
    return model
